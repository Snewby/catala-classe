<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#faf9f7">
<title>Catal√† A1.1</title>
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="assets/icons/android-icon-192x192.png">
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Source+Sans+3:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{background:#faf9f7;font-family:'Source Sans 3',system-ui,sans-serif;overflow-x:hidden;color:#1a1a2e}
button{font-family:inherit;cursor:pointer}
input{font-family:inherit}
::-webkit-scrollbar{display:none}
.serif{font-family:'DM Serif Display',Georgia,serif}
.app{max-width:420px;margin:0 auto;min-height:100vh;position:relative;padding-bottom:70px}
.nav{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:420px;background:rgba(255,255,255,.98);backdrop-filter:blur(20px);box-shadow:0 -2px 20px rgba(0,0,0,.08);display:flex;justify-content:space-around;padding:8px 0 16px;z-index:100;border-radius:20px 20px 0 0}
.nav button{background:none;border:none;display:flex;flex-direction:column;align-items:center;gap:3px;padding:6px 12px;color:#999;transition:all .3s;position:relative}
.nav button.active{color:#667eea}
.nav button.active::before{content:"";position:absolute;top:-8px;left:50%;transform:translateX(-50%);width:40px;height:3px;background:linear-gradient(90deg,#667eea,#764ba2);border-radius:2px}
.nav button span:first-child{font-size:22px;transition:transform .3s}
.nav button.active span:first-child{transform:scale(1.1)}
.nav button span:last-child{font-size:11px;font-weight:600}
/* Flashcards */
.flashcard-container{position:relative;touch-action:pan-y}
.flashcard-main{background:#fff;border-radius:20px;padding:40px 24px;text-align:center;box-shadow:0 2px 12px rgba(0,0,0,.06);margin-bottom:20px;border-top:3px solid var(--lesson-color);min-height:320px;display:flex;flex-direction:column;justify-content:center;transition:transform .3s}
.flashcard-main.flipped{transform:rotateY(180deg)}
.progress-dots{display:flex;justify-content:center;gap:6px;padding:12px 0;flex-wrap:wrap;max-height:60px;overflow:hidden}
.progress-dot{width:8px;height:8px;border-radius:50%;background:#e0e0e0;transition:all .3s;cursor:pointer;border:none;padding:0}
.progress-dot.active{background:var(--lesson-color);width:24px;border-radius:4px}
.progress-dot.completed{background:#4CAF50}
.progress-sections{display:flex;gap:8px;margin-top:16px}
.progress-section{flex:1;padding:10px;border-radius:10px;border:1px solid #ddd;background:#fff;font-size:12px;text-align:center;cursor:pointer;transition:all .2s}
.progress-section:hover{background:#f5f5f5}
.progress-section span{display:block;font-size:10px;color:#999;margin-top:2px}

/* Vocabulari */
.vocab-header{padding:20px 16px;background:linear-gradient(135deg,#FF6B6B 0%,#4ECDC4 100%);color:#fff}
.vocab-header h1{font-size:28px;margin-bottom:6px}
.vocab-header p{font-size:14px;opacity:.9}
.vocab-search{padding:12px 16px;background:#fff;border-bottom:1px solid #eee}
.vocab-search-input{width:100%;padding:10px 16px;border:1px solid #ddd;border-radius:24px;font-size:14px;background:#f8f8f8}
.vocab-search-input:focus{outline:none;border-color:#4ECDC4;background:#fff}
.vocab-filter{display:flex;gap:6px;padding:12px 16px;overflow-x:auto;background:#fff;border-bottom:2px solid #f5f5f5}
.vocab-filter button{padding:10px 16px;border-radius:24px;border:1px solid transparent;background:#f0f0f0;color:#666;font-size:13px;white-space:nowrap;font-weight:600;transition:all .2s}
.vocab-filter button.active{color:#fff;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);transform:scale(1.05)}
.vocab-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;padding:16px}
@media (min-width:380px){.vocab-grid{grid-template-columns:repeat(auto-fill,minmax(160px,1fr))}}
.vocab-card{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.08);cursor:pointer;transition:all .3s;position:relative}
.vocab-card:hover{transform:translateY(-4px);box-shadow:0 8px 24px rgba(0,0,0,.12)}
.vocab-card:active{transform:scale(.98)}
.vocab-card-img{width:100%;height:120px;object-fit:cover;background:linear-gradient(135deg,#f5f5f5 0%,#e0e0e0 100%)}
.vocab-card-badge{position:absolute;top:8px;right:8px;background:rgba(0,0,0,.6);color:#fff;padding:4px 8px;border-radius:12px;font-size:10px;font-weight:600}
.vocab-card-body{padding:14px}
.vocab-card-title{font-size:15px;font-weight:700;margin-bottom:4px;color:#333}
.vocab-card-subtitle{font-size:12px;color:#888;margin-bottom:8px}
.vocab-card-footer{display:flex;justify-content:space-between;align-items:center}
.vocab-card-page{font-size:10px;color:#aaa;font-weight:600}
.vocab-card-icon{font-size:16px}
.vocab-modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);z-index:1000;flex-direction:column}
.vocab-modal.show{display:flex}
.vocab-modal-header{display:flex;justify-content:space-between;align-items:center;padding:16px;background:rgba(250,249,247,.95);backdrop-filter:blur(12px)}
.vocab-modal-title{font-size:16px;font-weight:600;flex:1;text-align:center;padding:0 20px;color:#1a1a2e}
.vocab-modal-close{width:36px;height:36px;border-radius:50%;background:#eee;border:none;font-size:20px;cursor:pointer;display:flex;align-items:center;justify-content:center}
.vocab-modal-img-container{flex:1;display:flex;align-items:center;justify-content:center;overflow:hidden;padding:20px}
.vocab-modal-img{max-width:100%;max-height:100%;object-fit:contain;transition:transform .3s;transform-origin:center center;touch-action:none}
.vocab-modal-footer{padding:16px;background:rgba(250,249,247,.95);backdrop-filter:blur(12px);text-align:center;font-size:11px;color:#999}

/* Verbs */
.verb-header{display:flex;align-items:center;gap:10px;padding:12px 0;margin-bottom:12px}
.verb-selector{flex:1;padding:10px 14px;border:1px solid #ddd;border-radius:12px;font-size:15px;font-weight:600;color:#333;background:#fff;appearance:none;background-image:url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%23666' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 14px center;padding-right:40px}
.verb-tense-tabs{display:flex;gap:3px;overflow-x:auto;margin-bottom:16px;background:#f5f5f5;border-radius:12px;padding:4px}
.verb-tense-tab{padding:8px 14px;border-radius:8px;border:none;background:transparent;color:#666;font-size:12px;white-space:nowrap;font-weight:600;flex-shrink:0;transition:all .2s}
.verb-tense-tab.active{background:#fff;color:#333;box-shadow:0 2px 8px rgba(0,0,0,.08)}
.verb-info{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border-radius:16px;padding:20px;margin-bottom:16px}
.verb-info-title{font-size:24px;font-weight:700;margin-bottom:4px}
.verb-info-subtitle{font-size:14px;opacity:.9}
.verb-conjugation-grid{display:grid;gap:10px;margin-bottom:16px}
.verb-conjugation-card{background:#fff;border-radius:12px;padding:14px;border:1px solid #e5e5e5;transition:all .2s}
.verb-conjugation-card:hover{box-shadow:0 4px 12px rgba(0,0,0,.08);transform:translateY(-2px)}
.verb-pronoun{font-size:12px;color:#888;margin-bottom:6px;font-weight:600}
.verb-form-row{display:grid;grid-template-columns:1fr 1fr;gap:12px;align-items:center}
.verb-catalan{font-size:18px;font-weight:700;color:#2A7B5B}
.verb-catalan.irregular{color:#E74C3C}
.verb-french{font-size:14px;color:#4A54C4;font-style:italic}
.verb-practice-btn{width:100%;padding:12px;border-radius:12px;border:2px dashed #ddd;background:transparent;color:#999;font-size:14px;font-weight:600;transition:all .2s;cursor:pointer}
.verb-practice-btn:hover{border-color:#4A54C4;color:#4A54C4;background:#f8f8ff}

/* Quiz */
.quiz-header{text-align:center;padding:20px 0}
.quiz-progress{position:relative;width:120px;height:120px;margin:0 auto 16px}
.quiz-progress-ring{transform:rotate(-90deg);width:100%;height:100%}
.quiz-progress-circle{fill:none;stroke:#e0e0e0;stroke-width:8}
.quiz-progress-circle.active{stroke:#4CAF50;stroke-linecap:round;transition:stroke-dasharray .5s ease}
.quiz-progress-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:32px;font-weight:700;color:#333}
.quiz-progress-percent{font-size:14px;color:#888;font-weight:400}
.quiz-question{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border-radius:20px;padding:24px;text-align:center;margin-bottom:20px}
.quiz-question-lesson{font-size:12px;opacity:.8;text-transform:uppercase;letter-spacing:1.5px;margin-bottom:8px}
.quiz-question-text{font-size:24px;font-weight:600;line-height:1.3}
.quiz-answer{padding:16px 20px;border-radius:14px;border:2px solid #e5e5e5;background:#fff;font-size:16px;text-align:left;width:100%;margin-bottom:12px;transition:all .3s;cursor:pointer;position:relative;overflow:hidden}
.quiz-answer:hover{border-color:#667eea;background:#f8f8ff;transform:translateY(-2px);box-shadow:0 4px 12px rgba(102,126,234,.15)}
.quiz-answer.selected.correct{background:#E8F5E9;border-color:#4CAF50;animation:correctPulse .6s}
.quiz-answer.selected.wrong{background:#FFEBEE;border-color:#f44336;animation:shake .5s}
.quiz-answer-feedback{position:absolute;right:20px;top:50%;transform:translateY(-50%);font-size:24px;opacity:0;animation:fadeIn .3s forwards}
.quiz-complete{text-align:center;padding:40px 20px}
.quiz-complete-icon{font-size:80px;margin-bottom:20px;animation:bounce 1s}
.quiz-complete-score{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:48px;font-weight:700;margin-bottom:8px}
.quiz-complete-message{font-size:18px;color:#666;margin-bottom:24px}
@keyframes correctPulse{0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)}}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-10px)}75%{transform:translateX(10px)}}
@keyframes fadeIn{to{opacity:1}}
@keyframes bounce{0%,20%,50%,80%,100%{transform:translateY(0)}40%{transform:translateY(-20px)}60%{transform:translateY(-10px)}}
</style>
</head>
<body>
<div class="app" id="app"></div>
<script>
var LESSONS=[
{id:1,title:"Saludacions",subtitle:"Greetings & Basics",icon:"üëã",color:"#E85D3A",cards:[
{ca:"Bon dia!",en:"Good morning! Hello!"},{ca:"Ad√©u!",en:"Bye!"},{ca:"Com va aix√≤?",en:"How's it going?"},{ca:"B√©!",en:"Good!"},{ca:"Vaig fent.",en:"As always."},{ca:"Malament.",en:"Bad."},{ca:"Qu√® vol dir‚Ä¶?",en:"What does‚Ä¶ mean?"},{ca:"No ho s√©.",en:"I don't know."},{ca:"Ho pots repetir, si us plau?",en:"Can you repeat that, please?"},{ca:"(Moltes) gr√†cies!",en:"Thank you (very much)!"},{ca:"De res!",en:"You're welcome!"},{ca:"Ah, d'acord!",en:"Ah, I see."},{ca:"(Molt) b√©!",en:"(Very) good!"},{ca:"Que vagi (molt) b√©!",en:"All the best!"},{ca:"els deures",en:"homework"},{ca:"la classe de catal√†",en:"the Catalan class"}]},
{id:2,title:"L'alfabet",subtitle:"Alphabet & Sounds",icon:"üî§",color:"#2A7B5B",cards:[
{ca:"ll ‚Üí callar",en:"digraph: to be quiet"},{ca:"l¬∑l ‚Üí pel¬∑l√≠cula",en:"digraph: movie"},{ca:"ny ‚Üí any",en:"digraph: year"},{ca:"rr ‚Üí gerra",en:"digraph: jug"},{ca:"ss ‚Üí terrassa",en:"digraph: terrace"},{ca:"ix ‚Üí guix",en:"digraph: chalk"},{ca:"tx ‚Üí cotxe",en:"digraph: car"},{ca:"tj ‚Üí platja",en:"digraph: beach"},{ca:"tg ‚Üí equipatge",en:"digraph: luggage"},{ca:"√ß ‚Üí can√ß√≥",en:"ce trencada: song"},{ca:"√ß ‚Üí feli√ß",en:"ce trencada: happy"},{ca:"√ß ‚Üí abra√ßada",en:"ce trencada: hug"}]},
{id:3,title:"Presentar-se",subtitle:"Introductions",icon:"ü§ù",color:"#4A54C4",cards:[
{ca:"Com et dius?",en:"What's your name?"},{ca:"Em dic‚Ä¶",en:"My name is‚Ä¶"},{ca:"Soc la Txell. / Soc en Manel.",en:"I'm Txell. / I'm Manel."},{ca:"D'on ets?",en:"Where are you from?"},{ca:"Soc de Lleida.",en:"I'm from Lleida."},{ca:"Quines lleng√ºes parles?",en:"What languages do you speak?"},{ca:"Parlo el catal√† i el castell√†.",en:"I speak Catalan and Spanish."},{ca:"Encantat/da de con√®ixer-te!",en:"Nice to meet you!"},{ca:"Bona tarda!",en:"Good afternoon!"},{ca:"Bon vespre!",en:"Good evening!"}]},
{id:4,title:"Nacionalitats",subtitle:"Nationalities",icon:"üåç",color:"#C4A43A",cards:[
{ca:"espanyol / espanyola",en:"Spanish"},{ca:"catal√† / catalana",en:"Catalan"},{ca:"angl√®s / anglesa",en:"English"},{ca:"franc√®s / francesa",en:"French"},{ca:"alemany / alemanya",en:"German"},{ca:"itali√† / italiana",en:"Italian"},{ca:"portugu√®s / portuguesa",en:"Portuguese"},{ca:"japon√®s / japonesa",en:"Japanese"},{ca:"xin√®s / xinesa",en:"Chinese"},{ca:"mexic√† / mexicana",en:"Mexican"},{ca:"brasiler / brasilera",en:"Brazilian"},{ca:"estatunidenc / estatunidenca",en:"American"},{ca:"andorr√† / andorrana",en:"Andorran"},{ca:"holand√®s / holandesa",en:"Dutch"},{ca:"roman√®s / romanesa",en:"Romanian"},{ca:"marroqu√≠",en:"Moroccan"}]},
{id:5,title:"N√∫meros",subtitle:"Numbers 0‚Äì100",icon:"üî¢",color:"#8B3A8B",cards:[
{ca:"zero",en:"0"},{ca:"un / una",en:"1"},{ca:"dos / dues",en:"2"},{ca:"tres",en:"3"},{ca:"quatre",en:"4"},{ca:"cinc",en:"5"},{ca:"sis",en:"6"},{ca:"set",en:"7"},{ca:"vuit",en:"8"},{ca:"nou",en:"9"},{ca:"deu",en:"10"},{ca:"onze",en:"11"},{ca:"dotze",en:"12"},{ca:"tretze",en:"13"},{ca:"catorze",en:"14"},{ca:"quinze",en:"15"},{ca:"setze",en:"16"},{ca:"disset",en:"17"},{ca:"divuit",en:"18"},{ca:"dinou",en:"19"},{ca:"vint",en:"20"},{ca:"vint-i-un",en:"21"},{ca:"trenta",en:"30"},{ca:"quaranta",en:"40"},{ca:"cinquanta",en:"50"},{ca:"seixanta",en:"60"},{ca:"setanta",en:"70"},{ca:"vuitanta",en:"80"},{ca:"noranta",en:"90"},{ca:"cent",en:"100"}]},
{id:6,title:"La fam√≠lia",subtitle:"Family",icon:"üë™",color:"#D4564A",cards:[
{ca:"el pare / la mare",en:"father / mother"},{ca:"el germ√† / la germana",en:"brother / sister"},{ca:"el fill / la filla",en:"son / daughter"},{ca:"l'avi / l'√†via",en:"grandfather / grandmother"},{ca:"l'oncle / la tia",en:"uncle / aunt"},{ca:"el cos√≠ / la cosina",en:"cousin (m/f)"},{ca:"el nebot / la neboda",en:"nephew / niece"},{ca:"el net / la neta",en:"grandson / granddaughter"},{ca:"el xicot / la xicota",en:"boyfriend / girlfriend"},{ca:"el marit / la muller",en:"husband / wife"},{ca:"el cunyat / la cunyada",en:"in-law (sibling)"},{ca:"el sogre / la sogra",en:"in-law (parent)"},{ca:"el gos / la gossa",en:"dog (m/f)"},{ca:"el gat / la gata",en:"cat (m/f)"}]},
{id:7,title:"Professions",subtitle:"Jobs & Work",icon:"üíº",color:"#2B6B8A",cards:[
{ca:"el metge / la metgessa",en:"doctor"},{ca:"l'infermer / la infermera",en:"nurse"},{ca:"el mestre / la mestra",en:"teacher"},{ca:"el professor / la professora",en:"professor"},{ca:"el cuiner / la cuinera",en:"chef"},{ca:"el cambrer / la cambrera",en:"waiter/waitress"},{ca:"l'advocat / l'advocada",en:"lawyer"},{ca:"el/la policia",en:"police officer"},{ca:"el bomber / la bombera",en:"firefighter"},{ca:"el/la taxista",en:"taxi driver"},{ca:"el perruquer / la perruquera",en:"hairdresser"},{ca:"el pag√®s / la pagesa",en:"farmer"},{ca:"el periodista / la periodista",en:"journalist"},{ca:"l'arquitecte / l'arquitecta",en:"architect"}]},
{id:8,title:"Car√†cter",subtitle:"Personality",icon:"üé≠",color:"#6B4A8B",cards:[
{ca:"simp√†tic/a ‚Üî antip√†tic/a",en:"nice ‚Üî unfriendly"},{ca:"obert/a ‚Üî tancat/da",en:"open ‚Üî closed"},{ca:"t√≠mid/a ‚Üî extravertit/da",en:"shy ‚Üî extroverted"},{ca:"treballador/a ‚Üî mandr√≤s/osa",en:"hardworking ‚Üî lazy"},{ca:"gener√≥s/osa ‚Üî garrepa",en:"generous ‚Üî stingy"},{ca:"alegre ‚Üî trist/a",en:"happy ‚Üî sad"},{ca:"optimista ‚Üî pessimista",en:"optimist ‚Üî pessimist"},{ca:"amable ‚Üî hostil",en:"kind ‚Üî hostile"},{ca:"sincer/a ‚Üî mentider/a",en:"honest ‚Üî liar"},{ca:"valent/a ‚Üî poruc/ga",en:"brave ‚Üî cowardly"},{ca:"divertit/da ‚Üî avorr–∏—Ç/da",en:"fun ‚Üî boring"}]},
{id:9,title:"Agradar",subtitle:"Likes & Dislikes",icon:"‚ù§Ô∏è",color:"#C44A7B",cards:[
{ca:"M'agrada‚Ä¶",en:"I like‚Ä¶"},{ca:"M'encanta‚Ä¶",en:"I love‚Ä¶"},{ca:"No m'agrada‚Ä¶",en:"I don't like‚Ä¶"},{ca:"No m'agrada gens‚Ä¶",en:"I don't like‚Ä¶at all"},{ca:"A mi, tamb√©.",en:"Me too."},{ca:"A mi, tampoc.",en:"Me neither."},{ca:"A mi, no.",en:"Not me."},{ca:"A mi, s√≠.",en:"I do."},{ca:"molt√≠ssim",en:"very very much"},{ca:"molt",en:"a lot"},{ca:"for√ßa / bastant",en:"quite / rather"},{ca:"poc",en:"a little"},{ca:"no‚Ä¶gaire",en:"not much"},{ca:"no‚Ä¶gens ni mica",en:"not at all"}]},
{id:10,title:"Temps lliure",subtitle:"Free Time",icon:"üé®",color:"#3A8B5B",cards:[
{ca:"escoltar m√∫sica",en:"listen to music"},{ca:"llegir llibres",en:"read books"},{ca:"veure la tele",en:"watch TV"},{ca:"fer esport",en:"do sports"},{ca:"anar al cinema",en:"go to the cinema"},{ca:"cuinar",en:"cook"},{ca:"viatjar",en:"travel"},{ca:"anar de festa",en:"go partying"},{ca:"sortir amb amics",en:"go out with friends"},{ca:"jugar a videojocs",en:"play video games"},{ca:"c√≥rrer",en:"run"},{ca:"nedar",en:"swim"},{ca:"dibuixar",en:"draw"},{ca:"ballar",en:"dance"},{ca:"tocar un instrument",en:"play an instrument"}]},
{id:11,title:"Dies i mesos",subtitle:"Days & Months",icon:"üìÖ",color:"#5B8B8A",cards:[
{ca:"dilluns",en:"Monday"},{ca:"dimarts",en:"Tuesday"},{ca:"dimecres",en:"Wednesday"},{ca:"dijous",en:"Thursday"},{ca:"divendres",en:"Friday"},{ca:"dissabte",en:"Saturday"},{ca:"diumenge",en:"Sunday"},{ca:"gener",en:"January"},{ca:"febrer",en:"February"},{ca:"mar√ß",en:"March"},{ca:"abril",en:"April"},{ca:"maig",en:"May"},{ca:"juny",en:"June"},{ca:"juliol",en:"July"},{ca:"agost",en:"August"},{ca:"setembre",en:"September"},{ca:"octubre",en:"October"},{ca:"novembre",en:"November"},{ca:"desembre",en:"December"}]},
{id:12,title:"L'hora",subtitle:"Telling Time",icon:"üïê",color:"#8A5B3A",cards:[
{ca:"Quina hora √©s?",en:"What time is it?"},{ca:"S√≥n les dues.",en:"It's 2 o'clock."},{ca:"√âs la una.",en:"It's 1 o'clock."},{ca:"S√≥n les tres i cinc.",en:"It's 3:05."},{ca:"S√≥n les quatre i quart.",en:"It's 4:15."},{ca:"S√≥n les cinc i mitja.",en:"It's 5:30."},{ca:"S√≥n les sis menys quart.",en:"It's 5:45."},{ca:"S√≥n dos quarts de set.",en:"It's 6:30."},{ca:"S√≥n tres quarts de vuit.",en:"It's 7:45."},{ca:"√âs migdia.",en:"It's noon."},{ca:"√âs mitjanit.",en:"It's midnight."},{ca:"del mat√≠",en:"in the morning (AM)"},{ca:"de la tarda",en:"in the afternoon (PM)"},{ca:"de la nit",en:"at night (PM)"},{ca:"A quina hora‚Ä¶?",en:"At what time‚Ä¶?"}]},
{id:13,title:"Accions",subtitle:"Common Verbs",icon:"üèÉ",color:"#C45B3A",cards:[
{ca:"caminar",en:"to walk"},{ca:"parlar",en:"to speak"},{ca:"menjar",en:"to eat"},{ca:"beure",en:"to drink"},{ca:"dormir",en:"to sleep"},{ca:"treballar",en:"to work"},{ca:"estudiar",en:"to study"},{ca:"viure",en:"to live"},{ca:"comprar",en:"to buy"},{ca:"vendre",en:"to sell"},{ca:"obrir",en:"to open"},{ca:"tancar",en:"to close"},{ca:"escriure",en:"to write"},{ca:"llegir",en:"to read"},{ca:"escoltar",en:"to listen"},{ca:"mirar",en:"to watch/look"},{ca:"pensar",en:"to think"},{ca:"saber",en:"to know (facts)"},{ca:"con√®ixer",en:"to know (people/places)"},{ca:"poder",en:"can/to be able to"}]},
{id:14,title:"La ciutat",subtitle:"The City",icon:"üèôÔ∏è",color:"#4A8B6B",cards:[
{ca:"el carrer",en:"street"},{ca:"la pla√ßa",en:"square"},{ca:"l'avinguda",en:"avenue"},{ca:"el parc",en:"park"},{ca:"la biblioteca",en:"library"},{ca:"el museu",en:"museum"},{ca:"el supermercat",en:"supermarket"},{ca:"la farm√†cia",en:"pharmacy"},{ca:"l'hospital",en:"hospital"},{ca:"l'estaci√≥",en:"station"},{ca:"el metro",en:"metro"},{ca:"l'autob√∫s",en:"bus"},{ca:"el taxi",en:"taxi"},{ca:"la bicicleta",en:"bicycle"},{ca:"la botiga",en:"shop"},{ca:"el restaurant",en:"restaurant"},{ca:"el caf√®",en:"caf√©"},{ca:"el banc",en:"bank"},{ca:"la universitat",en:"university"},{ca:"l'oficina de correus",en:"post office"}]},
{id:15,title:"Colors",subtitle:"Colors",icon:"üåà",color:"#8B4A6B",cards:[
{ca:"blanc/a",en:"white"},{ca:"negre/a",en:"black"},{ca:"gris/a",en:"grey"},{ca:"vermell/a",en:"red"},{ca:"taronja",en:"orange"},{ca:"groc/a",en:"yellow"},{ca:"verd/a",en:"green"},{ca:"blau/blava",en:"blue"},{ca:"lila",en:"purple"},{ca:"rosa",en:"pink"},{ca:"marr√≥",en:"brown"},{ca:"daurat/da",en:"golden"},{ca:"platejat/da",en:"silver"},{ca:"clar/a",en:"light"},{ca:"fosc/a",en:"dark"}]}
];

var VERBS=[
{v:"ser",en:"to be",fr:"√™tre",t:"permanent",tenses:{pres:{jo:"soc",tu:"ets","ell/ella/vost√®":"√©s",nosaltres:"som",vosaltres:"sou","ells/elles/vost√®s":"s√≥n"},perf:{jo:"vaig ser",tu:"vas ser","ell/ella/vost√®":"va ser",nosaltres:"vam ser",vosaltres:"vau ser","ells/elles/vost√®s":"van ser"},imp:{jo:"era",tu:"eres","ell/ella/vost√®":"era",nosaltres:"√®rem",vosaltres:"√®reu","ells/elles/vost√®s":"eren"},fut:{jo:"ser√©",tu:"ser√†s","ell/ella/vost√®":"ser√†",nosaltres:"serem",vosaltres:"sereu","ells/elles/vost√®s":"seran"},cond:{jo:"seria",tu:"series","ell/ella/vost√®":"seria",nosaltres:"ser√≠em",vosaltres:"ser√≠eu","ells/elles/vost√®s":"serien"},imper:{tu:"sigues","vost√®":"sigui",vosaltres:"sigueu","vost√®s":"siguin"}}},
{v:"estar",en:"to be",fr:"√™tre",t:"temporary",tenses:{pres:{jo:"estic",tu:"est√†s","ell/ella/vost√®":"est√†",nosaltres:"estem",vosaltres:"esteu","ells/elles/vost√®s":"estan"},perf:{jo:"vaig estar",tu:"vas estar","ell/ella/vost√®":"va estar",nosaltres:"vam estar",vosaltres:"vau estar","ells/elles/vost√®s":"van estar"},imp:{jo:"estava",tu:"estaves","ell/ella/vost√®":"estava",nosaltres:"est√†vem",vosaltres:"est√†veu","ells/elles/vost√®s":"estaven"},fut:{jo:"estar√©",tu:"estar√†s","ell/ella/vost√®":"estar√†",nosaltres:"estarem",vosaltres:"estareu","ells/elles/vost√®s":"estaran"},cond:{jo:"estaria",tu:"estaries","ell/ella/vost√®":"estaria",nosaltres:"estar√≠em",vosaltres:"estar√≠eu","ells/elles/vost√®s":"estarien"},imper:{tu:"estigues","vost√®":"estigui",vosaltres:"estigueu","vost√®s":"estiguin"}}},
{v:"haver",en:"to have",fr:"avoir",t:"auxiliary",tenses:{pres:{jo:"he",tu:"has","ell/ella/vost√®":"ha",nosaltres:"hem",vosaltres:"heu","ells/elles/vost√®s":"han"},perf:{jo:"vaig haver",tu:"vas haver","ell/ella/vost√®":"va haver",nosaltres:"vam haver",vosaltres:"vau haver","ells/elles/vost√®s":"van haver"},imp:{jo:"havia",tu:"havies","ell/ella/vost√®":"havia",nosaltres:"hav√≠em",vosaltres:"hav√≠eu","ells/elles/vost√®s":"havien"},fut:{jo:"haur√©",tu:"haur√†s","ell/ella/vost√®":"haur√†",nosaltres:"haurem",vosaltres:"haureu","ells/elles/vost√®s":"hauran"},cond:{jo:"hauria",tu:"hauries","ell/ella/vost√®":"hauria",nosaltres:"haur√≠em",vosaltres:"haur√≠eu","ells/elles/vost√®s":"haurien"}}},
{v:"tenir",en:"to have",fr:"avoir/tenir",t:"possession",tenses:{pres:{jo:"tinc",tu:"tens","ell/ella/vost√®":"t√©",nosaltres:"tenim",vosaltres:"teniu","ells/elles/vost√®s":"tenen"},perf:{jo:"vaig tenir",tu:"vas tenir","ell/ella/vost√®":"va tenir",nosaltres:"vam tenir",vosaltres:"vau tenir","ells/elles/vost√®s":"van tenir"},imp:{jo:"tenia",tu:"tenies","ell/ella/vost√®":"tenia",nosaltres:"ten√≠em",vosaltres:"ten√≠eu","ells/elles/vost√®s":"tenien"},fut:{jo:"tindr√©",tu:"tindr√†s","ell/ella/vost√®":"tindr√†",nosaltres:"tindrem",vosaltres:"tindreu","ells/elles/vost√®s":"tindran"},cond:{jo:"tindria",tu:"tindries","ell/ella/vost√®":"tindria",nosaltres:"tindr√≠em",vosaltres:"tindr√≠eu","ells/elles/vost√®s":"tindrien"},imper:{tu:"tingues","vost√®":"tingui",vosaltres:"tingueu","vost√®s":"tinguin"}}},
{v:"fer",en:"to do/make",fr:"faire",t:"",tenses:{pres:{jo:"faig",tu:"fas","ell/ella/vost√®":"fa",nosaltres:"fem",vosaltres:"feu","ells/elles/vost√®s":"fan"},perf:{jo:"vaig fer",tu:"vas fer","ell/ella/vost√®":"va fer",nosaltres:"vam fer",vosaltres:"vau fer","ells/elles/vost√®s":"van fer"},imp:{jo:"feia",tu:"feies","ell/ella/vost√®":"feia",nosaltres:"f√®iem",vosaltres:"f√®ieu","ells/elles/vost√®s":"feien"},fut:{jo:"far√©",tu:"far√†s","ell/ella/vost√®":"far√†",nosaltres:"farem",vosaltres:"fareu","ells/elles/vost√®s":"faran"},cond:{jo:"faria",tu:"faries","ell/ella/vost√®":"faria",nosaltres:"far√≠em",vosaltres:"far√≠eu","ells/elles/vost√®s":"farien"},imper:{tu:"fes","vost√®":"faci",vosaltres:"feu","vost√®s":"facin"}}},
{v:"anar",en:"to go",fr:"aller",t:"",tenses:{pres:{jo:"vaig",tu:"vas","ell/ella/vost√®":"va",nosaltres:"anem",vosaltres:"aneu","ells/elles/vost√®s":"van"},perf:{jo:"vaig anar",tu:"vas anar","ell/ella/vost√®":"va anar",nosaltres:"vam anar",vosaltres:"vau anar","ells/elles/vost√®s":"van anar"},imp:{jo:"anava",tu:"anaves","ell/ella/vost√®":"anava",nosaltres:"an√†vem",vosaltres:"an√†veu","ells/elles/vost√®s":"anaven"},fut:{jo:"anir√©",tu:"anir√†s","ell/ella/vost√®":"anir√†",nosaltres:"anirem",vosaltres:"anireu","ells/elles/vost√®s":"aniran"},cond:{jo:"aniria",tu:"aniries","ell/ella/vost√®":"aniria",nosaltres:"anir√≠em",vosaltres:"anir√≠eu","ells/elles/vost√®s":"anirien"},imper:{tu:"v√©s","vost√®":"vagi",vosaltres:"aneu","vost√®s":"vagin"}}},
{v:"dir",en:"to say/tell",t:"",tenses:{pres:{jo:"dic",tu:"dius","ell/ella/vost√®":"diu",nosaltres:"diem",vosaltres:"dieu","ells/elles/vost√®s":"diuen"},imp:{jo:"deia",tu:"deies","ell/ella/vost√®":"deia",nosaltres:"d√®iem",vosaltres:"d√®ieu","ells/elles/vost√®s":"deien"},fut:{jo:"dir√©",tu:"dir√†s","ell/ella/vost√®":"dir√†",nosaltres:"direm",vosaltres:"direu","ells/elles/vost√®s":"diran"}}},
{v:"venir",en:"to come",t:"",tenses:{pres:{jo:"vinc",tu:"v√©ns","ell/ella/vost√®":"ve/v√©",nosaltres:"venim",vosaltres:"veniu","ells/elles/vost√®s":"venen"},imp:{jo:"venia",tu:"venies","ell/ella/vost√®":"venia",nosaltres:"ven√≠em",vosaltres:"ven√≠eu","ells/elles/vost√®s":"venien"},fut:{jo:"vindr√©",tu:"vindr√†s","ell/ella/vost√®":"vindr√†",nosaltres:"vindrem",vosaltres:"vindreu","ells/elles/vost√®s":"vindran"}}},
{v:"voler",en:"to want",t:"",tenses:{pres:{jo:"vull",tu:"vols","ell/ella/vost√®":"vol",nosaltres:"volem",vosaltres:"voleu","ells/elles/vost√®s":"volen"},imp:{jo:"volia",tu:"volies","ell/ella/vost√®":"volia",nosaltres:"vol√≠em",vosaltres:"vol√≠eu","ells/elles/vost√®s":"volien"},fut:{jo:"voldr√©",tu:"voldr√†s","ell/ella/vost√®":"voldr√†",nosaltres:"voldrem",vosaltres:"voldreu","ells/elles/vost√®s":"voldran"}}},
{v:"poder",en:"can/to be able",t:"",tenses:{pres:{jo:"puc",tu:"pots","ell/ella/vost√®":"pot",nosaltres:"podem",vosaltres:"podeu","ells/elles/vost√®s":"poden"},imp:{jo:"podia",tu:"podies","ell/ella/vost√®":"podia",nosaltres:"pod√≠em",vosaltres:"pod√≠eu","ells/elles/vost√®s":"podien"},fut:{jo:"podr√©",tu:"podr√†s","ell/ella/vost√®":"podr√†",nosaltres:"podrem",vosaltres:"podreu","ells/elles/vost√®s":"podran"}}},
{v:"saber",en:"to know",t:"",tenses:{pres:{jo:"s√©",tu:"saps","ell/ella/vost√®":"sap",nosaltres:"sabem",vosaltres:"sabeu","ells/elles/vost√®s":"saben"},imp:{jo:"sabia",tu:"sabies","ell/ella/vost√®":"sabia",nosaltres:"sab√≠em",vosaltres:"sab√≠eu","ells/elles/vost√®s":"sabien"},fut:{jo:"sabr√©",tu:"sabr√†s","ell/ella/vost√®":"sabr√†",nosaltres:"sabrem",vosaltres:"sabreu","ells/elles/vost√®s":"sabran"}}},
{v:"parlar",en:"to speak",t:"regular -ar",tenses:{pres:{jo:"parlo",tu:"parles","ell/ella/vost√®":"parla",nosaltres:"parlem",vosaltres:"parleu","ells/elles/vost√®s":"parlen"},perf:{jo:"vaig parlar",tu:"vas parlar","ell/ella/vost√®":"va parlar",nosaltres:"vam parlar",vosaltres:"vau parlar","ells/elles/vost√®s":"van parlar"},imp:{jo:"parlava",tu:"parlaves","ell/ella/vost√®":"parlava",nosaltres:"parl√†vem",vosaltres:"parl√†veu","ells/elles/vost√®s":"parlaven"},fut:{jo:"parlar√©",tu:"parlar√†s","ell/ella/vost√®":"parlar√†",nosaltres:"parlarem",vosaltres:"parlareu","ells/elles/vost√®s":"parlaran"}}},
{v:"menjar",en:"to eat",t:"regular -ar",tenses:{pres:{jo:"menjo",tu:"menges","ell/ella/vost√®":"menja",nosaltres:"mengem",vosaltres:"mengeu","ells/elles/vost√®s":"mengen"},perf:{jo:"vaig menjar",tu:"vas menjar","ell/ella/vost√®":"va menjar",nosaltres:"vam menjar",vosaltres:"vau menjar","ells/elles/vost√®s":"van menjar"},imp:{jo:"menjava",tu:"menjaves","ell/ella/vost√®":"menjava",nosaltres:"menj√†vem",vosaltres:"menj√†veu","ells/elles/vost√®s":"menjaven"},fut:{jo:"menjar√©",tu:"menjar√†s","ell/ella/vost√®":"menjar√†",nosaltres:"menjarem",vosaltres:"menjareu","ells/elles/vost√®s":"menjaran"}}},
{v:"aprendre",en:"to learn",t:"regular -re",tenses:{pres:{jo:"aprenc",tu:"aprens","ell/ella/vost√®":"apr√®n",nosaltres:"aprenem",vosaltres:"apreneu","ells/elles/vost√®s":"aprenen"},imp:{jo:"aprenia",tu:"aprenies","ell/ella/vost√®":"aprenia",nosaltres:"apren√≠em",vosaltres:"apren√≠eu","ells/elles/vost√®s":"aprenien"},fut:{jo:"aprendr√©",tu:"aprendr√†s","ell/ella/vost√®":"aprendr√†",nosaltres:"aprendrem",vosaltres:"aprendreu","ells/elles/vost√®s":"aprendran"}}},
{v:"viure",en:"to live",t:"regular -re",tenses:{pres:{jo:"visc",tu:"vius","ell/ella/vost√®":"viu",nosaltres:"vivim",vosaltres:"viviu","ells/elles/vost√®s":"viuen"},imp:{jo:"vivia",tu:"vivies","ell/ella/vost√®":"vivia",nosaltres:"viv√≠em",vosaltres:"viv√≠eu","ells/elles/vost√®s":"vivien"},fut:{jo:"viur√©",tu:"viur√†s","ell/ella/vost√®":"viur√†",nosaltres:"viurem",vosaltres:"viureu","ells/elles/vost√®s":"viuran"}}}
];

var TENSES=[
{id:"pres",name:"Present",desc:"Actions happening now or habitually"},
{id:"perf",name:"Passat",desc:"Completed past actions (most common)"},
{id:"imp",name:"Imperfet",desc:"Past actions that were ongoing or habitual"},
{id:"fut",name:"Futur",desc:"Actions that will happen"},
{id:"cond",name:"Condicional",desc:"Actions that would happen"},
{id:"imper",name:"Imperatiu",desc:"Commands and requests"}
];

var POSS=[
{p:"jo",f:["el meu","la meva","els meus","les meves"]},
{p:"tu",f:["el teu","la teva","els teus","les teves"]},
{p:"ell/ella/vost√®",f:["el seu","la seva","els seus","les seves"]},
{p:"nosaltres",f:["el nostre","la nostra","els nostres","les nostres"]},
{p:"vosaltres",f:["el vostre","la vostra","els vostres","les vostres"]},
{p:"ells/elles/vost√®s",f:["el seu","la seva","els seus","les seves"]}
];

var PRONOUN_MAP={
"jo":"je",
"tu":"tu",
"ell/ella/vost√®":"il",
"nosaltres":"nous",
"vosaltres":"vous",
"ells/elles/vost√®s":"ils"
};

var PRONOUN_FR={
"jo":"je",
"tu":"tu",
"ell/ella/vost√®":"il/elle/vous",
"nosaltres":"nous",
"vosaltres":"vous",
"ells/elles/vost√®s":"ils/elles"
};

var TENSE_FR={
"pres":"pr√©sent",
"perf":"pass√© compos√©",
"imp":"imparfait",
"fut":"futur",
"cond":"conditionnel",
"imper":"imp√©ratif"
};

var FREQ=[
{c:"sempre",e:"always",p:100},{c:"gaireb√© sempre",e:"almost always",p:90},{c:"normalment",e:"normally",p:80},{c:"sovint",e:"often",p:70},{c:"de vegades",e:"sometimes",p:50},{c:"poques vegades",e:"rarely",p:30},{c:"gaireb√© mai",e:"almost never",p:10},{c:"mai",e:"never",p:0}
];

function getFrenchForm(frVerb,frPronoun,tense){
  // Basic French conjugation patterns - simplified
  var forms={
    "√™tre":{
      pres:{"je":"suis","tu":"es","il/elle/vous":"est/est/√™tes","nous":"sommes","vous":"√™tes","ils/elles":"sont"},
      perf:{"je":"ai √©t√©","tu":"as √©t√©","il/elle/vous":"a √©t√©/a √©t√©/avez √©t√©","nous":"avons √©t√©","vous":"avez √©t√©","ils/elles":"ont √©t√©"},
      imp:{"je":"√©tais","tu":"√©tais","il/elle/vous":"√©tait/√©tait/√©tiez","nous":"√©tions","vous":"√©tiez","ils/elles":"√©taient"},
      fut:{"je":"serai","tu":"seras","il/elle/vous":"sera/sera/serez","nous":"serons","vous":"serez","ils/elles":"seront"},
      cond:{"je":"serais","tu":"serais","il/elle/vous":"serait/serait/seriez","nous":"serions","vous":"seriez","ils/elles":"seraient"},
      imper:{"tu":"sois","il/elle/vous":"qu'il soit/qu'elle soit/soyez","nous":"soyons","vous":"soyez","ils/elles":"qu'ils soient"}
    },
    "avoir":{
      pres:{"je":"ai","tu":"as","il/elle/vous":"a/a/avez","nous":"avons","vous":"avez","ils/elles":"ont"},
      perf:{"je":"ai eu","tu":"as eu","il/elle/vous":"a eu/a eu/avez eu","nous":"avons eu","vous":"avez eu","ils/elles":"ont eu"},
      imp:{"je":"avais","tu":"avais","il/elle/vous":"avait/avait/aviez","nous":"avions","vous":"aviez","ils/elles":"avaient"},
      fut:{"je":"aurai","tu":"auras","il/elle/vous":"aura/aura/aurez","nous":"aurons","vous":"aurez","ils/elles":"auront"},
      cond:{"je":"aurais","tu":"aurais","il/elle/vous":"aurait/aurait/auriez","nous":"aurions","vous":"auriez","ils/elles":"auraient"}
    },
    "faire":{
      pres:{"je":"fais","tu":"fais","il/elle/vous":"fait/fait/faites","nous":"faisons","vous":"faites","ils/elles":"font"},
      perf:{"je":"ai fait","tu":"as fait","il/elle/vous":"a fait/a fait/avez fait","nous":"avons fait","vous":"avez fait","ils/elles":"ont fait"},
      fut:{"je":"ferai","tu":"feras","il/elle/vous":"fera/fera/ferez","nous":"ferons","vous":"ferez","ils/elles":"feront"}
    },
    "aller":{
      pres:{"je":"vais","tu":"vas","il/elle/vous":"va/va/allez","nous":"allons","vous":"allez","ils/elles":"vont"},
      perf:{"je":"suis all√©(e)","tu":"es all√©(e)","il/elle/vous":"est all√©/est all√©e/√™tes all√©(e)","nous":"sommes all√©(e)s","vous":"√™tes all√©(e)s","ils/elles":"sont all√©s/all√©es"},
      fut:{"je":"irai","tu":"iras","il/elle/vous":"ira/ira/irez","nous":"irons","vous":"irez","ils/elles":"iront"}
    }
  };

  if(forms[frVerb]&&forms[frVerb][tense]&&forms[frVerb][tense][frPronoun]){
    return frPronoun+" "+forms[frVerb][tense][frPronoun];
  }

  // Default pattern for regular verbs
  if(tense==="pres"){
    if(frPronoun==="je")return frPronoun+" "+frVerb.replace(/er$/,"e").replace(/ir$/,"is").replace(/re$/,"s");
    if(frPronoun==="tu")return frPronoun+" "+frVerb.replace(/er$/,"es").replace(/ir$/,"is").replace(/re$/,"s");
    if(frPronoun==="nous")return frPronoun+" "+frVerb.replace(/er$/,"ons").replace(/ir$/,"issons").replace(/re$/,"ons");
  }

  return frPronoun+" "+frVerb;
}

function $(tag,attr,kids){var el=document.createElement(tag);if(attr){Object.keys(attr).forEach(function(k){if(k==="cls")el.className=attr[k];else if(k==="css")el.style.cssText=attr[k];else if(k==="html")el.innerHTML=attr[k];else if(k.startsWith("on"))el.addEventListener(k.slice(2),attr[k]);else el.setAttribute(k,attr[k]);});}if(kids){if(!Array.isArray(kids))kids=[kids];kids.forEach(function(c){if(c===null||c===undefined)return;if(typeof c==="string")el.appendChild(document.createTextNode(c));else el.appendChild(c);});}return el;}

var screen="fitxes";
var vocabSection="all";
var vocabPage=null;
var vocabScale=1;
var selL=null;
var fIdx=0;
var qI=0;
var qSc=0;
var qSel=null;
var qQs=[];
var gTab="poss";
var gVTense="pres";
var selectedVerb=0;

function lsSave(){localStorage.setItem("catalaApp",JSON.stringify({selL:selL,fIdx:fIdx,qI:qI,qSc:qSc,gTab:gTab,gVTense:gVTense}));}
function lsLoad(){try{var d=JSON.parse(localStorage.getItem("catalaApp"));if(d){selL=d.selL||null;fIdx=d.fIdx||0;qI=d.qI||0;qSc=d.qSc||0;gTab=d.gTab||"poss";gVTense=d.gVTense||"pres";}}catch(e){}}
lsLoad();

function go(s){screen=s;if(s==="quiz"&&qI===0){var all=[];LESSONS.forEach(function(l){l.cards.forEach(function(c){all.push({lesson:l.title,q:c.ca,a:c.en});all.push({lesson:l.title,q:c.en,a:c.ca});});});qQs=all.sort(function(){return Math.random()-.5;}).slice(0,20);qQs.forEach(function(q){var wrongOpts=all.filter(function(x){return x.a!==q.a;}).sort(function(){return Math.random()-.5;}).slice(0,3).map(function(x){return x.a;});q.opts=[q.a].concat(wrongOpts).sort(function(){return Math.random()-.5;});});}R();lsSave();}

function R(){
var app=document.getElementById("app");
app.innerHTML="";
var scr=$("div",{css:"padding:16px 16px 0"});

if(screen==="fitxes"){
  scr.appendChild($("div",{css:"padding:8px 0 24px"},[$("div",{cls:"serif",css:"font-size:28px;letter-spacing:-.5px"},"Catal√†"),$("div",{css:"font-size:13px;color:#888;margin-top:2px"},"A1.1 Curs B√†sic")]));
  LESSONS.forEach(function(l){
    var pct=0;if(selL===l.id){pct=Math.round((fIdx/(l.cards.length||1))*100);}
    scr.appendChild($("div",{css:"background:#fff;border-radius:16px;padding:16px 18px;margin-bottom:12px;box-shadow:0 1px 6px rgba(0,0,0,.05);border-left:3px solid "+l.color,onclick:function(){selL=l.id;fIdx=0;go("flashcards");lsSave();}},[$("div",{css:"display:flex;align-items:center;gap:10px;margin-bottom:4px"},[$("span",{css:"font-size:24px"},l.icon),$("div",{cls:"serif",css:"font-size:18px;flex:1"},l.title),$("div",{css:"font-size:11px;color:#999"},l.cards.length+" fitxes")]),$("div",{css:"font-size:12px;color:#666;margin-bottom:8px"},l.subtitle),pct>0?$("div",{css:"background:#f0f0f0;border-radius:4px;height:4px;overflow:hidden"},[$("div",{css:"width:"+pct+"%;background:"+l.color+";height:100%;border-radius:4px"})]):null]));
  });
}

else if(screen==="flashcards"){
  if(selL===null){go("fitxes");return;}
  var l=LESSONS.find(function(x){return x.id===selL;});

  // Header
  scr.appendChild($("div",{css:"display:flex;align-items:center;padding:16px 0;gap:12px"},[$("button",{css:"background:none;border:none;font-size:22px;color:#555",onclick:function(){selL=null;fIdx=0;go("fitxes");lsSave();}},"\u2190"),$("div",{css:"flex:1"},[$("div",{cls:"serif",css:"font-size:18px"},l.icon+" "+l.title),$("div",{css:"font-size:11px;color:#888"},l.subtitle)]),$("div",{css:"font-size:12px;color:#999"},(fIdx+1)+" / "+l.cards.length)]));

  // Progress bar
  var progressBar=$("div",{css:"height:4px;background:#e0e0e0;border-radius:4px;margin-bottom:20px;overflow:hidden"});
  progressBar.appendChild($("div",{css:"width:"+(((fIdx+1)/l.cards.length)*100)+"%;height:100%;background:"+l.color+";transition:width .3s;border-radius:4px"}));
  scr.appendChild(progressBar);

  // Flashcard with swipe support
  var c=l.cards[fIdx];
  var cardContainer=$("div",{cls:"flashcard-container"});
  var card=$("div",{cls:"flashcard-main",css:"--lesson-color:"+l.color},[$("div",{cls:"serif",css:"font-size:32px;margin-bottom:20px;line-height:1.3;color:#1a1a2e"},c.ca),$("div",{css:"font-size:16px;color:#666"},c.en)]);

  // Touch handling for swipe
  var startX=0,currentX=0,isDragging=false;
  card.addEventListener("touchstart",function(e){if(e.touches.length===1){startX=e.touches[0].clientX;isDragging=true;}});
  card.addEventListener("touchmove",function(e){if(isDragging&&e.touches.length===1){currentX=e.touches[0].clientX;var diff=currentX-startX;if(Math.abs(diff)>10){card.style.transform="translateX("+diff*.3+"px)";}}});
  card.addEventListener("touchend",function(){if(isDragging){var diff=startX-currentX;card.style.transform="";if(Math.abs(diff)>50){if(diff>0&&fIdx<l.cards.length-1){fIdx++;R();lsSave();}else if(diff<0&&fIdx>0){fIdx--;R();lsSave();}}isDragging=false;}});

  cardContainer.appendChild(card);
  scr.appendChild(cardContainer);

  // Navigation buttons
  var ctrls=$("div",{css:"display:flex;gap:8px;margin-bottom:20px"});
  var prevBtn=$("button",{css:"flex:1;padding:12px;border-radius:12px;border:1px solid #ddd;background:#fff;font-size:15px;font-weight:600;color:#555;opacity:"+(fIdx===0?".3":"1"),onclick:function(){if(fIdx>0){fIdx--;R();lsSave();}}},"\u2190 Enrere");
  if(fIdx===0)prevBtn.disabled=true;
  ctrls.appendChild(prevBtn);

  var nextBtn=$("button",{css:"flex:1;padding:12px;border-radius:12px;border:none;background:"+l.color+";font-size:15px;font-weight:600;color:#fff;opacity:"+(fIdx===l.cards.length-1?".3":"1"),onclick:function(){if(fIdx<l.cards.length-1){fIdx++;R();lsSave();}}},("Seg√ºent \u2192"));
  if(fIdx===l.cards.length-1)nextBtn.disabled=true;
  ctrls.appendChild(nextBtn);
  scr.appendChild(ctrls);

  // Progress dots (max 15 visible)
  var dots=$("div",{cls:"progress-dots"});
  var maxDots=15;
  if(l.cards.length<=maxDots){
    // Show all dots
    for(var i=0;i<l.cards.length;i++){
      (function(idx){
        dots.appendChild($("button",{cls:"progress-dot"+(idx===fIdx?" active":"")+(idx<fIdx?" completed":""),css:"--lesson-color:"+l.color,onclick:function(){fIdx=idx;R();lsSave();}}));
      })(i);
    }
  }else{
    // Show condensed dots
    var step=Math.ceil(l.cards.length/maxDots);
    for(var i=0;i<l.cards.length;i+=step){
      (function(idx){
        var isNear=Math.abs(idx-fIdx)<=step;
        dots.appendChild($("button",{cls:"progress-dot"+(Math.abs(idx-fIdx)<step/2?" active":"")+(idx<fIdx?" completed":""),css:"--lesson-color:"+l.color,onclick:function(){fIdx=idx;R();lsSave();}}));
      })(i);
    }
  }
  scr.appendChild(dots);

  // Section jumpers
  var sections=$("div",{cls:"progress-sections"});
  sections.appendChild($("button",{cls:"progress-section",onclick:function(){fIdx=0;R();lsSave();}},["Inici",$("span",{},"Fitxa 1")]));
  sections.appendChild($("button",{cls:"progress-section",onclick:function(){fIdx=Math.floor(l.cards.length/2);R();lsSave();}},["Mig",$("span",{},"Fitxa "+(Math.floor(l.cards.length/2)+1))]));
  sections.appendChild($("button",{cls:"progress-section",onclick:function(){fIdx=l.cards.length-1;R();lsSave();}},["Final",$("span",{},"Fitxa "+l.cards.length)]));
  scr.appendChild(sections);
}

else if(screen==="quiz"){
  // Quiz header with progress ring
  var header=$("div",{cls:"quiz-header"});
  var progressDiv=$("div",{cls:"quiz-progress"});
  var percent=qI>0?Math.round((qSc/qI)*100):0;
  var circumference=2*Math.PI*54; // radius = 54
  var dashArray=qI>0?(percent/100)*circumference:0;

  progressDiv.innerHTML='<svg class="quiz-progress-ring"><circle cx="60" cy="60" r="54" class="quiz-progress-circle"/><circle cx="60" cy="60" r="54" class="quiz-progress-circle active" style="stroke-dasharray:'+dashArray+','+circumference+'"/></svg><div class="quiz-progress-text">'+qSc+'/'+qI+'<div class="quiz-progress-percent">'+percent+'%</div></div>';
  header.appendChild(progressDiv);
  header.appendChild($("div",{cls:"serif",css:"font-size:28px;margin-bottom:4px"},"‚ö° Quiz R√†pid"));
  header.appendChild($("div",{css:"font-size:14px;color:#888"},"20 preguntes aleat√≤ries"));
  scr.appendChild(header);

  if(qI>=qQs.length){
    // Quiz complete screen
    var complete=$("div",{cls:"quiz-complete"});
    complete.appendChild($("div",{cls:"quiz-complete-icon"},"\u{1F389}"));
    complete.appendChild($("div",{cls:"quiz-complete-score"},Math.round((qSc/qQs.length)*100)+"%"));
    complete.appendChild($("div",{cls:"quiz-complete-message"},"Has encertat "+qSc+" de "+qQs.length+" preguntes"));

    var message="";
    var pct=Math.round((qSc/qQs.length)*100);
    if(pct>=90)message="Excel¬∑lent! Ets un expert!";
    else if(pct>=70)message="Molt b√©! Continues millorant!";
    else if(pct>=50)message="Bona feina! Segueix practicant!";
    else message="√Änim! La pr√†ctica fa el mestre!";

    complete.appendChild($("div",{css:"font-size:16px;color:#999;margin-bottom:32px"},message));
    complete.appendChild($("button",{css:"padding:14px 32px;border-radius:14px;border:none;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;font-size:16px;font-weight:600;box-shadow:0 4px 20px rgba(102,126,234,.3)",onclick:function(){qI=0;qSc=0;qSel=null;go("quiz");}},"üîÑ Tornar a comen√ßar"));
    scr.appendChild(complete);
  }else{
    // Current question
    var q=qQs[qI];
    var question=$("div",{cls:"quiz-question"});
    question.appendChild($("div",{cls:"quiz-question-lesson"},q.lesson));
    question.appendChild($("div",{cls:"quiz-question-text"},q.q));
    scr.appendChild(question);

    // Answer options
    q.opts.forEach(function(o){
      var isA=o===q.a;
      var isS=qSel===o;
      var btn=$("button",{cls:"quiz-answer"+(qSel!==null?(isA?" selected correct":(isS?" selected wrong":"")):""),onclick:function(){
        if(qSel!==null)return;
        qSel=o;
        if(o===q.a){
          qSc++;
          this.innerHTML+=`<span class="quiz-answer-feedback">‚úì</span>`;
        }else{
          this.innerHTML+=`<span class="quiz-answer-feedback">‚úó</span>`;
        }
        R();
        setTimeout(function(){qSel=null;qI++;R();window.scrollTo(0,0);},1000);
      }},o);
      scr.appendChild(btn);
    });
  }
}

else if(screen==="vocab"){
  // Header with gradient
  var header=$("div",{cls:"vocab-header"});
  header.appendChild($("h1",{cls:"serif"},"üìñ Vocabulari"));
  header.appendChild($("p",{},"58 p√†gines il¬∑lustrades"));
  scr.appendChild(header);

  // Search bar
  var searchContainer=$("div",{cls:"vocab-search"});
  var searchInput=$("input",{cls:"vocab-search-input",type:"text",placeholder:"üîç Buscar vocabulari...",oninput:function(){
    var query=this.value.toLowerCase();
    var cards=document.querySelectorAll('.vocab-card');
    cards.forEach(function(card){
      var title=card.querySelector('.vocab-card-title').textContent.toLowerCase();
      var subtitle=card.querySelector('.vocab-card-subtitle').textContent.toLowerCase();
      card.style.display=(title.includes(query)||subtitle.includes(query))?'block':'none';
    });
  }});
  searchContainer.appendChild(searchInput);
  scr.appendChild(searchContainer);

  // Section filter with improved styling
  var filter=$("div",{cls:"vocab-filter"});
  [{id:"all",name:"Tots",icon:"üìö"}].concat(typeof VOCAB_SECTIONS!=='undefined'?VOCAB_SECTIONS:[]).forEach(function(s){
    filter.appendChild($("button",{cls:vocabSection===s.id?"active":"",onclick:function(){vocabSection=s.id;R();}},s.icon+" "+s.name));
  });
  scr.appendChild(filter);

  // Enhanced grid
  var grid=$("div",{cls:"vocab-grid"});
  var filtered=typeof VOCABULARI!=='undefined'?(vocabSection==="all"?VOCABULARI:VOCABULARI.filter(function(v){return v.section===vocabSection;})):[];

  filtered.forEach(function(v,idx){
    var card=$("div",{cls:"vocab-card",onclick:function(){vocabPage=v;screen="vocab-page";R();}});

    // Add badge for new items (first 5)
    if(idx<5&&vocabSection==="all"){
      card.innerHTML='<span class="vocab-card-badge">NOU</span>';
    }

    card.appendChild($("img",{cls:"vocab-card-img",src:v.img,alt:v.title}));
    var body=$("div",{cls:"vocab-card-body"});
    body.appendChild($("div",{cls:"vocab-card-title"},v.title));
    body.appendChild($("div",{cls:"vocab-card-subtitle"},v.subtitle));
    var footer=$("div",{cls:"vocab-card-footer"});
    footer.appendChild($("span",{cls:"vocab-card-page"},"P√†g "+v.page));
    footer.appendChild($("span",{cls:"vocab-card-icon"},v.icon||"üìö"));
    body.appendChild(footer);
    card.appendChild(body);
    grid.appendChild(card);
  });
  scr.appendChild(grid);
}

else if(screen==="vocab-page"&&vocabPage){
  // Remove any existing modals first
  var existingModal=document.querySelector('.vocab-modal');
  if(existingModal){
    existingModal.remove();
  }

  var modal=document.createElement('div');
  modal.className='vocab-modal show';

  var header=document.createElement('div');
  header.className='vocab-modal-header';
  var closeBtn=document.createElement('button');
  closeBtn.className='vocab-modal-close';
  closeBtn.textContent='‚Üê';
  closeBtn.onclick=function(){
    modal.remove();
    screen='vocab';
    R();
  };
  var titleDiv=document.createElement('div');
  titleDiv.className='vocab-modal-title';
  titleDiv.textContent=vocabPage.title;
  var spacerDiv=document.createElement('div');
  spacerDiv.style.width='36px';
  header.appendChild(closeBtn);
  header.appendChild(titleDiv);
  header.appendChild(spacerDiv);
  modal.appendChild(header);

  var imgContainer=document.createElement('div');
  imgContainer.className='vocab-modal-img-container';
  var img=document.createElement('img');
  img.className='vocab-modal-img';
  img.src=vocabPage.img;
  img.alt=vocabPage.title;

  // Pinch zoom and navigation handling
  var lastDist=0;
  var startX=0, startY=0;
  var currentX=0, currentY=0;
  var panX=0, panY=0;
  var isDragging=false;
  var isZooming=false;
  var isPanning=false;
  var touchStartTime=0;

  imgContainer.addEventListener('touchstart',function(e){
    touchStartTime=Date.now();

    if(e.touches.length===2){
      // Two fingers - start zoom
      isZooming=true;
      isDragging=false;
      isPanning=false;
      lastDist=Math.hypot(e.touches[0].pageX-e.touches[1].pageX,e.touches[0].pageY-e.touches[1].pageY);
    }else if(e.touches.length===1){
      startX=e.touches[0].clientX;
      startY=e.touches[0].clientY;

      if(vocabScale>1){
        // When zoomed, use single finger for panning
        isPanning=true;
        isDragging=false;
      }else{
        // When not zoomed, use single finger for navigation
        isDragging=true;
        isPanning=false;
      }
      isZooming=false;
    }
  });

  imgContainer.addEventListener('touchmove',function(e){
    if(e.touches.length===2 || isZooming){
      // Zooming with two fingers
      e.preventDefault();
      isDragging=false;
      isPanning=false;

      if(e.touches.length===2){
        var dist=Math.hypot(e.touches[0].pageX-e.touches[1].pageX,e.touches[0].pageY-e.touches[1].pageY);
        if(lastDist>0){
          vocabScale*=dist/lastDist;
          vocabScale=Math.max(1,Math.min(4,vocabScale));
          img.style.transform='scale('+vocabScale+') translate('+panX+'px,'+panY+'px)';
        }
        lastDist=dist;
      }
    }else if(isPanning && e.touches.length===1 && vocabScale>1){
      // Panning when zoomed
      e.preventDefault();
      var deltaX=e.touches[0].clientX-startX;
      var deltaY=e.touches[0].clientY-startY;
      panX+=deltaX*0.5;
      panY+=deltaY*0.5;

      // Limit pan to reasonable bounds
      var maxPan=100*vocabScale;
      panX=Math.max(-maxPan,Math.min(maxPan,panX));
      panY=Math.max(-maxPan,Math.min(maxPan,panY));

      img.style.transform='scale('+vocabScale+') translate('+panX+'px,'+panY+'px)';
      startX=e.touches[0].clientX;
      startY=e.touches[0].clientY;
    }else if(isDragging && e.touches.length===1 && vocabScale===1){
      // Track swipe only when not zoomed
      currentX=e.touches[0].clientX;
      currentY=e.touches[0].clientY;
    }
  });

  imgContainer.addEventListener('touchend',function(e){
    var touchDuration=Date.now()-touchStartTime;

    // Reset zoom if pinched back to normal
    if(isZooming && e.touches.length===0){
      lastDist=0;
      isZooming=false;
      if(vocabScale<=1.1){
        vocabScale=1;
        panX=0;
        panY=0;
        img.style.transform='scale(1)';
      }
    }

    // Only process swipe navigation if not zoomed and not panning
    if(isDragging && !isZooming && !isPanning && vocabScale===1 && touchDuration<500){
      var diff=startX-currentX;
      var filtered=typeof VOCABULARI!=='undefined'?(vocabSection==="all"?VOCABULARI:VOCABULARI.filter(function(v){return v.section===vocabSection;})):[];
      var currentIndex=filtered.findIndex(function(v){return v.page===vocabPage.page;});

      // Only navigate if horizontal swipe is dominant
      var horizontalSwipe=Math.abs(startX-currentX);
      var verticalSwipe=Math.abs(startY-currentY);

      if(horizontalSwipe>verticalSwipe && horizontalSwipe>80){
        if(diff>0 && currentIndex<filtered.length-1){
          // Swipe left - next page
          vocabPage=filtered[currentIndex+1];
          modal.remove();
          R();
        }else if(diff<0 && currentIndex>0){
          // Swipe right - previous page
          vocabPage=filtered[currentIndex-1];
          modal.remove();
          R();
        }
      }
    }

    isDragging=false;
    isPanning=false;
  });

  // Add navigation arrows
  var navContainer=document.createElement('div');
  navContainer.style='position:absolute;top:50%;left:0;right:0;display:flex;justify-content:space-between;padding:0 10px;pointer-events:none';

  var filtered=typeof VOCABULARI!=='undefined'?(vocabSection==="all"?VOCABULARI:VOCABULARI.filter(function(v){return v.section===vocabSection;})):[];
  var currentIndex=filtered.findIndex(function(v){return v.page===vocabPage.page;});

  if(currentIndex>0){
    var prevBtn=document.createElement('button');
    prevBtn.style='width:40px;height:40px;border-radius:50%;background:rgba(0,0,0,0.5);color:white;border:none;font-size:20px;pointer-events:auto;cursor:pointer';
    prevBtn.textContent='‚Äπ';
    prevBtn.onclick=function(){
      vocabPage=filtered[currentIndex-1];
      modal.remove();
      R();
    };
    navContainer.appendChild(prevBtn);
  }else{
    navContainer.appendChild(document.createElement('div'));
  }

  if(currentIndex<filtered.length-1){
    var nextBtn=document.createElement('button');
    nextBtn.style='width:40px;height:40px;border-radius:50%;background:rgba(0,0,0,0.5);color:white;border:none;font-size:20px;pointer-events:auto;cursor:pointer';
    nextBtn.textContent='‚Ä∫';
    nextBtn.onclick=function(){
      vocabPage=filtered[currentIndex+1];
      modal.remove();
      R();
    };
    navContainer.appendChild(nextBtn);
  }else{
    navContainer.appendChild(document.createElement('div'));
  }

  modal.appendChild(navContainer);

  var footer=document.createElement('div');
  footer.className='vocab-modal-footer';
  footer.textContent='Pin√ßa per fer zoom ‚Ä¢ Llisca per navegar ‚Ä¢ Toca ‚Üê per tornar';
  modal.appendChild(footer);

  document.body.appendChild(modal);
  return; // Don't append nav for modal
}

else if(screen==="verbs"){
  // Use new VERB_DATA instead of old VERBS
  if(!window.VERB_DATA || VERB_DATA.length===0){
    scr.appendChild($("div",{css:"padding:20px;text-align:center;color:#999"},"Loading verb data..."));
    return;
  }

  // Header with verb selector
  var headerContainer=$("div",{cls:"verb-header"});
  headerContainer.appendChild($("span",{css:"font-size:24px"},"üî§"));
  var selector=$("select",{cls:"verb-selector"});
  VERB_DATA.forEach(function(v,i){
    var opt=$("option",{value:i},v.ca+" - "+v.fr);
    if(i===selectedVerb)opt.selected=true;
    selector.appendChild(opt);
  });
  selector.onchange=function(){selectedVerb=parseInt(this.value);R();};
  headerContainer.appendChild(selector);
  scr.appendChild(headerContainer);

  var verb=VERB_DATA[selectedVerb];

  // Verb info card
  var infoCard=$("div",{cls:"verb-info"});
  infoCard.appendChild($("div",{cls:"verb-info-title"},verb.ca));
  infoCard.appendChild($("div",{cls:"verb-info-subtitle"},verb.en+" ‚Ä¢ "+verb.fr+(verb.type?" ‚Ä¢ "+verb.type:"")));
  scr.appendChild(infoCard);

  // Tense tabs
  var tenseTabs=$("div",{cls:"verb-tense-tabs"});
  TENSES.forEach(function(t){
    if(!verb.catalan || !verb.catalan[t.id])return;
    tenseTabs.appendChild($("button",{cls:"verb-tense-tab"+(gVTense===t.id?" active":""),onclick:function(){gVTense=t.id;R();}},t.name));
  });
  scr.appendChild(tenseTabs);

  // Show conjugations in single table card
  var tenseObj=TENSES.find(function(t){return t.id===gVTense;});
  if(tenseObj && verb.catalan && verb.catalan[gVTense]){
    var catalanForms=verb.catalan[gVTense];
    var frenchForms=verb.french && verb.french[gVTense] || {};
    var frTense=TENSE_FR[gVTense]||gVTense;

    // Single conjugation card with all forms
    var conjugations=$("div",{css:"background:#fff;border-radius:16px;padding:20px;box-shadow:0 2px 12px rgba(0,0,0,.08);margin-top:16px"});

    // Tense description
    conjugations.appendChild($("div",{css:"font-size:12px;color:#888;font-style:italic;margin-bottom:16px;padding-bottom:14px;border-bottom:1px solid #f0f0f0;text-align:center"},tenseObj.desc+" ‚Ä¢ "+frTense));

    // Header row
    conjugations.appendChild($("div",{css:"display:grid;grid-template-columns:1fr 1.2fr 1.2fr;gap:8px 16px;margin-bottom:12px;padding-bottom:10px;border-bottom:2px solid #f5f5f5;font-size:12px;color:#999;font-weight:700"},[$("div",{css:"text-align:right"},"Pronom"),$("div",{},"Catal√†"),$("div",{},"Fran√ßais")]));

    // All conjugations in one table
    var tableRows=$("div",{css:"display:grid;grid-template-columns:1fr 1.2fr 1.2fr;gap:12px 16px"});

    Object.entries(catalanForms).forEach(function(entry){
      var catalanPronoun=entry[0];
      var catalanForm=entry[1];
      var frenchPronoun=PRONOUN_MAP ? PRONOUN_MAP[catalanPronoun] : catalanPronoun;
      var frenchForm=frenchForms[frenchPronoun] || "‚Äî";

      // Check if irregular
      var isIrregular=verb.type && !verb.type.includes("regular");

      // Format French form with elision
      var frenchDisplay=frenchForm;
      if(frenchPronoun==="je" && /^[ae√©√®√™i√Øo√¥u√π√ªyh]/i.test(frenchForm)){
        frenchDisplay="j'"+frenchForm;
      }else if(frenchPronoun && frenchForm!=="‚Äî"){
        frenchDisplay=frenchPronoun+" "+frenchForm;
      }

      // Add row
      tableRows.appendChild($("div",{css:"font-size:14px;color:#666;text-align:right;font-weight:500"},catalanPronoun));
      tableRows.appendChild($("div",{css:"font-size:16px;font-weight:700;color:"+(isIrregular?"#E74C3C":"#2A7B5B")},catalanForm));
      tableRows.appendChild($("div",{css:"font-size:15px;color:#4A54C4;font-style:italic"},frenchDisplay));
    });

    conjugations.appendChild(tableRows);
    scr.appendChild(conjugations);

    // Practice button
    scr.appendChild($("button",{css:"width:100%;padding:14px;margin-top:16px;border-radius:12px;border:2px dashed #ddd;background:transparent;color:#999;font-size:14px;font-weight:600;transition:all .2s;cursor:pointer",onmouseover:function(){this.style.borderColor="#4A54C4";this.style.color="#4A54C4";this.style.background="#f8f8ff";},onmouseout:function(){this.style.borderColor="#ddd";this.style.color="#999";this.style.background="transparent";},onclick:function(){alert("Pr√†ctica: Funci√≥ en desenvolupament!");}},"üéØ Practicar aquest temps verbal"));
  }
}

else if(screen==="gram"){
  scr.appendChild($("div",{css:"display:flex;align-items:center;padding:16px 0;gap:12px"},[$("div",{cls:"serif",css:"font-size:22px;flex:1"},"üìù Gram√†tica")]));
  var tabs=$("div",{css:"display:flex;gap:6px;overflow-x:auto;margin-bottom:16px"});
  [{id:"poss",l:"Possessius"},{id:"freq",l:"Freq√º√®ncia"},{id:"art",l:"Articles"}].forEach(function(t){
    tabs.appendChild($("button",{css:"padding:8px 14px;border-radius:20px;border:"+(gTab===t.id?"none":"1px solid #ddd")+";background:"+(gTab===t.id?"#2A7B5B":"#fff")+";color:"+(gTab===t.id?"#fff":"#555")+";font-size:13px;white-space:nowrap;font-weight:600;flex-shrink:0",onclick:function(){gTab=t.id;R();}},t.l));
  });scr.appendChild(tabs);
  if(gTab==="poss")scr.appendChild($("div",{css:"background:#fff;border-radius:14px;padding:16px;border:1px solid #eee"},[$("div",{cls:"serif",css:"font-size:16px;margin-bottom:12px"},"Els possessius"),$("div",{css:"display:grid;grid-template-columns:auto 1fr;gap:6px 16px;font-size:13px",html:'<div style="font-weight:700;color:#666">Pronom</div><div style="font-weight:700;color:#666">m.sg ¬∑ f.sg ¬∑ m.pl ¬∑ f.pl</div>'+POSS.map(function(p){return'<div style="color:#4A54C4;font-weight:600">'+p.p+'</div><div style="color:#333">'+p.f.join(" ¬∑ ")+'</div>';}).join("")}),$("div",{css:"margin-top:14px;padding:10px 14px;background:#FFF8E1;border-radius:10px;font-size:12px;color:#795548;line-height:1.5",html:'<b>Exemple:</b> Aquesta √©s <em>la meva</em> fam√≠lia. <em>El meu</em> germ√† es diu Oriol.'})]));
  if(gTab==="freq")scr.appendChild($("div",{css:"background:#fff;border-radius:14px;padding:16px;border:1px solid #eee",html:'<div class="serif" style="font-size:16px;margin-bottom:14px">Adverbis de freq√º√®ncia</div>'+FREQ.map(function(a){return'<div style="display:flex;align-items:center;gap:12px;margin-bottom:8px"><div style="width:100px;flex-shrink:0"><div style="background:#e8e8e8;border-radius:4px;height:8px;overflow:hidden"><div style="width:'+a.p+'%;height:100%;background:hsl('+(a.p*1.2)+',60%,50%);border-radius:4px"></div></div></div><div style="font-size:14px"><span style="font-weight:600">'+a.c+'</span> <span style="color:#999">('+a.e+')</span></div></div>';}).join("")}));
  if(gTab==="art"){
    scr.appendChild($("div",{css:"background:#fff;border-radius:14px;padding:16px;border:1px solid #eee;margin-bottom:14px",html:'<div class="serif" style="font-size:16px;margin-bottom:10px">L\'article definit</div><div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:4px;text-align:center;font-size:14px"><div style="font-weight:700;color:#666"></div><div style="font-weight:700;color:#666">Masc.</div><div style="font-weight:700;color:#666">Fem.</div><div style="color:#999">Sg.</div><div style="font-weight:600">el (l\')</div><div style="font-weight:600">la (l\')</div><div style="color:#999">Pl.</div><div style="font-weight:600">els</div><div style="font-weight:600">les</div></div>'}));
    scr.appendChild($("div",{css:"background:#fff;border-radius:14px;padding:16px;border:1px solid #eee;margin-bottom:14px",html:'<div class="serif" style="font-size:16px;margin-bottom:10px">Article personal</div><div style="font-size:13px;line-height:1.8"><div><span style="color:#999">home + consonant ‚Üí</span> <b>el / en</b> Manel</div><div><span style="color:#999">home + vocal ‚Üí</span> <b>l\'</b>Andreu</div><div><span style="color:#999">dona + consonant ‚Üí</span> <b>la</b> Txell</div><div><span style="color:#999">dona + vocal ‚Üí</span> <b>l\'</b>Anna</div></div>'}));
    scr.appendChild($("div",{css:"background:#fff;border-radius:14px;padding:16px;border:1px solid #eee;margin-bottom:14px",html:'<div class="serif" style="font-size:16px;margin-bottom:10px">"de" + article</div><div style="font-size:13px;line-height:1.8"><b>de</b> ‚Üí Lleida<br><b>d\'</b> ‚Üí Andorra<br><b>del</b> (de+el) ‚Üí del Marroc<br><b>de l\'</b> ‚Üí de l\'Argentina<br><b>de la</b> ‚Üí de la Rep√∫blica Txeca<br><b>dels</b> (de+els) ‚Üí dels Estats Units<br><b>de les</b> ‚Üí de les Illes Balears</div>'}));
    scr.appendChild($("div",{css:"background:#FFF8E1;border-radius:14px;padding:16px;border:1px solid #FFF0C0;margin-bottom:14px",html:'<div class="serif" style="font-size:14px;margin-bottom:8px;color:#795548">‚ö†Ô∏è Apostrophe rule</div><div style="font-size:12px;color:#795548;line-height:1.6">Feminine words starting with unstressed <b>hi-, i-, hu-, u-</b> do NOT apostrophize!<br><em>la hist√≤ria, la universitat, la illeta, la unitat</em></div>'}));
  }
}

app.appendChild(scr);
var nav=$("div",{cls:"nav"});
[{id:"fitxes",ic:"üìö",l:"Fitxes"},{id:"quiz",ic:"‚ö°",l:"Quiz"},{id:"vocab",ic:"üìñ",l:"Vocabulari"},{id:"verbs",ic:"üî§",l:"Verbs"},{id:"gram",ic:"üìù",l:"Gram√†tica"}].forEach(function(it){
  nav.appendChild($("button",{cls:screen===it.id?"active":"",onclick:function(){go(it.id);}},[$("span",{},it.ic),$("span",{},it.l)]));
});app.appendChild(nav);
}
R();
</script>
<script src="js/vocabulari-data.js"></script>
<script src="js/verb-conjugations.js"></script>
<script>
// Register service worker for PWA
if('serviceWorker' in navigator){
  window.addEventListener('load',function(){
    navigator.serviceWorker.register('./sw.js', { scope: './' }).then(function(reg){
      console.log('Service Worker registered');
    }).catch(function(err){
      console.log('Service Worker registration failed:',err);
    });
  });
}
</script>
</body>
</html>
